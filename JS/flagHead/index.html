<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <title>国旗头像生成</title>
   <style>
   *{
      margin: 0;
      padding: 0;
   }
   .app{
      width: 100%;
      display: flex;
      justify-content: center;
      align-content: center;
   }
   canvas{
      border: 1px dashed blue;
   }
   input{  
      position: absolute;
      top: 50%;   
   }
   </style>
</head>
<body>
   <div class="app">
      <input type="file" id="fileInput" value="上传文件"/>
      <canvas id="preview" width = "290px" height="290px"></canvas>
   </div>
   <script>
   const fileInput = document.getElementById('fileInput');
   const preview = document.getElementById('preview');
   fileInput.addEventListener('change', function(event){
      let file = event.target.files[0];
      let fileReader = new FileReader();
      fileReader.onload = function(event){
         const imgFile = event.target.result;
         draw(imgFile);
      }
      fileReader.readAsDataURL(file);

   })
   function draw(imgFile){
      const ctx = preview.getContext('2d');
      ctx.width = 290;
      ctx.height = 290;
      //<img />
      // createElement('img');
      const avatar = new Image();
      avatar.onload = function(){
         //ctx.drawImage(imgFile, 0, 0, 290, 290);
         ctx.drawImage(avatar, 0, 0, 290, 290);

         const icon = new Image();
         icon.onload = function(){
            ctx.drawImage(icon, 0, 0, 290, 290);
         }
         icon.src ='./img/icon.png';
      }
      avatar.src = imgFile;
   }
   </script>
</body>
</html>